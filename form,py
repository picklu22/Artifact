import streamlit as st
import pandas as pd

# ------------------ Page Config ------------------ #
st.set_page_config(
    page_title="Excel to CSV Converter",
    page_icon="ðŸ“Š",
    layout="centered"
)

# ------------------ Custom Styling ------------------ #
st.markdown("""
    <style>
        .main-title {
            font-size:28px !important;
            font-weight:600;
            text-align:center;
            margin-bottom:20px;
        }
        .stButton>button {
            width:100%;
            border-radius:8px;
            height:45px;
            font-size:16px;
        }
        .stDownloadButton>button {
            width:100%;
            border-radius:8px;
            height:45px;
            font-size:16px;
        }
    </style>
""", unsafe_allow_html=True)

st.markdown('<div class="main-title">ðŸ“Š Excel â†’ CSV Converter</div>', unsafe_allow_html=True)

st.write("Upload your Excel file and convert it instantly to CSV format.")

# ------------------ Upload Section ------------------ #
with st.container():
    uploaded_file = st.file_uploader(
        "Upload Excel File",
        type=["xlsx", "xls"]
    )

if uploaded_file is not None:
    with st.spinner("Reading Excel file..."):
        df = pd.read_excel(uploaded_file)

    st.success("File uploaded successfully âœ…")

    col1, col2 = st.columns(2)

    with col1:
        st.metric("Rows", df.shape[0])
    with col2:
        st.metric("Columns", df.shape[1])

    # Preview Option
    if st.toggle("Preview Data"):
        st.dataframe(df, use_container_width=True)

    st.divider()

    # ------------------ Convert Section ------------------ #
    if st.button("ðŸš€ Convert to CSV"):
        with st.spinner("Converting to CSV..."):
            csv = df.to_csv(index=False).encode("utf-8")

        st.success("Conversion completed ðŸŽ‰")

        st.download_button(
            label="â¬‡ Download CSV File",
            data=csv,
            file_name="converted_file.csv",
            mime="text/csv"
        )

else:
    st.info("Please upload an Excel file to begin.")
