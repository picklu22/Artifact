import streamlit as st
import pandas as pd

# ------------------ Page Config ------------------ #
st.set_page_config(
    page_title="Excel to CSV Converter",
    page_icon="ğŸŒˆ",
    layout="centered"
)

# ------------------ Custom CSS ------------------ #
st.markdown("""
<style>

body {
    background: linear-gradient(135deg, #667eea, #764ba2);
}

.main-title {
    font-size: 34px;
    font-weight: 700;
    text-align: center;
    color: white;
    margin-bottom: 20px;
}

.card {
    background: white;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0px 10px 30px rgba(0,0,0,0.15);
}

.stButton>button {
    background: linear-gradient(90deg, #ff512f, #dd2476);
    color: white;
    border-radius: 10px;
    height: 50px;
    font-size: 16px;
    font-weight: bold;
    border: none;
}

.stDownloadButton>button {
    background: linear-gradient(90deg, #00c6ff, #0072ff);
    color: white;
    border-radius: 10px;
    height: 50px;
    font-size: 16px;
    font-weight: bold;
    border: none;
}

</style>
""", unsafe_allow_html=True)

st.markdown('<div class="main-title">ğŸŒˆ Excel â†’ CSV Converter</div>', unsafe_allow_html=True)

st.markdown('<div class="card">', unsafe_allow_html=True)

st.write("Upload your Excel file and convert it instantly to CSV format ğŸš€")

# ------------------ Upload Section ------------------ #
uploaded_file = st.file_uploader(
    "ğŸ“‚ Upload Excel File",
    type=["xlsx", "xls"]
)

if uploaded_file is not None:
    with st.spinner("âœ¨ Reading your file..."):
        df = pd.read_excel(uploaded_file)

    st.success("ğŸ‰ File uploaded successfully!")

    col1, col2 = st.columns(2)

    with col1:
        st.metric("ğŸ“Š Total Rows", df.shape[0])
    with col2:
        st.metric("ğŸ“ Total Columns", df.shape[1])

    if st.toggle("ğŸ‘€ Preview Data"):
        st.dataframe(df, use_container_width=True)

    st.divider()

    if st.button("ğŸš€ Convert to CSV"):
        with st.spinner("ğŸ”„ Converting..."):
            csv = df.to_csv(index=False).encode("utf-8")

        st.success("âœ… Conversion Completed!")

        st.download_button(
            label="â¬‡ Download CSV File",
            data=csv,
            file_name="converted_file.csv",
            mime="text/csv"
        )

else:
    st.info("ğŸ‘† Upload an Excel file to get started.")

st.markdown('</div>', unsafe_allow_html=True)
